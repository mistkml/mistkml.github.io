

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Testing &mdash; MISTK  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Deployment" href="deployment.html" />
    <link rel="prev" title="Guide" href="guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MISTK
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#running-the-model">Running the Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-in-eclipse-and-pydev">Running in Eclipse and PyDev</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-through-the-restful-api">Testing through the RESTful API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialize-model">Initialize Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-model">Build Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#load-data">Load Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-predictions">Save Predictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#save-model-checkpoint">Save Model Checkpoint</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#test-and-validation-harness">Test and Validation Harness</a></li>
<li class="toctree-l2"><a class="reference internal" href="#validation-metrics">Validation Metrics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">MISTK API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MISTK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Testing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/testing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="running-the-model">
<h2>Running the Model<a class="headerlink" href="#running-the-model" title="Permalink to this headline">¶</a></h2>
<p>All models are ultimately run as web services with endpoints corresponding to the
implemented <cite>AbstractModel</cite> methods. The model endpoint service is supplied by
the <cite>mistk</cite> module. To run the model endpoint service, call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk</span> <span class="p">[</span><span class="n">module</span><span class="p">]</span> <span class="p">[</span><span class="n">class</span><span class="p">]</span>
</pre></div>
</div>
<p>where ‘module’ is the python module being loaded and ‘class’ is the class which implements AbstractModel as
described above.  This will start the endpoint service listening on the localhost at
port 8080.  You can view the endpoint API by browsing to <a class="reference external" href="http://localhost:8080/v1/mistk/ui">http://localhost:8080/v1/mistk/ui</a>.</p>
<p>You must ensure that the module  files are on the PYTHONPATH or are executing the command
model’s project base directory. An example of executing the linear regression model previously referenced:</p>
<blockquote>
<div><p>python -m mistk scikit_learn.logistic_regression ScikitLearnLogisticRegressionModel</p>
</div></blockquote>
<p>You can then use the UI to manually kick off instructions to the model.</p>
</div>
<div class="section" id="running-in-eclipse-and-pydev">
<h2>Running in Eclipse and PyDev<a class="headerlink" href="#running-in-eclipse-and-pydev" title="Permalink to this headline">¶</a></h2>
<p>The following steps assume that Eclipse has been installed, along with the PyDev
Eclipse plugin, the MISTK library has been installed in your python environment,
developer has familiarity with Eclipse debugging tools, and your Python path
has been properly configured.</p>
<p>Create a new Python run configuration similar to the example below and update
the highlighted fields with your project specific values.</p>
<img alt="_images/Run_Config_1.png" src="_images/Run_Config_1.png" />
<img alt="_images/Run_Config_2.png" src="_images/Run_Config_2.png" />
<p>Running the program should produce the following output in Eclipse (along with
any additional logging you perform):</p>
<img alt="_images/Run_Output.png" src="_images/Run_Output.png" />
<p>You should also be able to access the Model Instance Endpoint Swagger UI through
web browser at <a class="reference external" href="http://localhost:8080/v1/mistk/ui/">http://localhost:8080/v1/mistk/ui/</a></p>
<img alt="_images/MISTK_Model_Swagger_UI.png" src="_images/MISTK_Model_Swagger_UI.png" />
</div>
<div class="section" id="testing-through-the-restful-api">
<h2>Testing through the RESTful API<a class="headerlink" href="#testing-through-the-restful-api" title="Permalink to this headline">¶</a></h2>
<p>The RESTful API for a running model can be accessed at <a class="reference external" href="http://localhost:8080/v1/mistk/ui">http://localhost:8080/v1/mistk/ui</a>.
The RESTful API endpoints correspond to the Pythonic API endpoints (ie. MISTK
model methods beginning with ‘<a href="#id2"><span class="problematic" id="id3">do_</span></a>’) in terms of their input parameters and
return values. The primary difference is that parameter names are in camelcase
format rather than underscored (ie. datasetMap vs. dataset_map). The API method call
examples below include sample input arguments when running the PyTorch model.</p>
<div class="section" id="initialize-model">
<h3>Initialize Model<a class="headerlink" href="#initialize-model" title="Permalink to this headline">¶</a></h3>
<img alt="_images/swagger_initialize.png" src="_images/swagger_initialize.png" />
</div>
<div class="section" id="build-model">
<h3>Build Model<a class="headerlink" href="#build-model" title="Permalink to this headline">¶</a></h3>
<img alt="_images/swagger_buildModel.png" src="_images/swagger_buildModel.png" />
</div>
<div class="section" id="load-data">
<h3>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">¶</a></h3>
<img alt="_images/swagger_loadData.png" src="_images/swagger_loadData.png" />
</div>
<div class="section" id="save-predictions">
<h3>Save Predictions<a class="headerlink" href="#save-predictions" title="Permalink to this headline">¶</a></h3>
<img alt="_images/swagger_savePredictions.png" src="_images/swagger_savePredictions.png" />
</div>
<div class="section" id="save-model-checkpoint">
<h3>Save Model Checkpoint<a class="headerlink" href="#save-model-checkpoint" title="Permalink to this headline">¶</a></h3>
<img alt="_images/swagger_saveModel.png" src="_images/swagger_saveModel.png" />
</div>
</div>
<div class="section" id="test-and-validation-harness">
<h2>Test and Validation Harness<a class="headerlink" href="#test-and-validation-harness" title="Permalink to this headline">¶</a></h2>
<p>Model implementations can also be validated using the Test Harness application,
instead of manually accessing the RESTful endpoints.
The Test Harness is a command-line application that can exercise model implementations
via the model endpoints, launching the model within its Docker container
(see <cite>Containerization</cite> section), or launching the model within the test harness itself.
The Test Harness should be used by model developers to ensure that their model
implementations properly implement all interfaces and can be integrated into the
MISTK framework. It provides streamlined testing for model implementations.
The Test Harness Python wheel files can be downloaded from the MISTK
Github Repository <a class="reference external" href="https://github.com/mistkml/mistk/releases">Releases page</a> and installed with <cite>pip</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mistk</span><span class="o">-</span><span class="n">test</span><span class="o">-</span><span class="n">harness</span><span class="o">-*-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
</pre></div>
</div>
<p>The Test Harness accepts a number of optional parameters to specify which model activities
should be run (i.e. training, testing, evaluation, etc.) and can
be used to exercise all model endpoints except pause, resume, and terminate. The Test Harness
also has the capabilities to perform data transformations as well as evaluating a model with different metrics.
The parameters and example usage are below, and can also be retrieved by running the Test Harness
with the ‘-h’ option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">train</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">predict</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">props</span> <span class="n">FILE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">hyperparams</span> <span class="n">FILE</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">stream</span><span class="o">-</span><span class="n">predict</span> <span class="n">FILE</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">transform</span> <span class="n">TRANSFORM</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">paths</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">properties</span> <span class="n">FILE</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">evaluate</span> <span class="n">TYPE</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">evaluation</span> <span class="n">EVALUATION</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">properties</span> <span class="n">FILE</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">metrics</span> <span class="n">METRIC</span><span class="p">]</span>
                                  <span class="p">[</span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">shutdown</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">logs</span><span class="p">]</span>

<span class="n">Test</span> <span class="n">harness</span> <span class="k">for</span> <span class="n">validating</span> <span class="n">model</span> <span class="n">implementations</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">model</span> <span class="n">MODEL</span>         <span class="n">Model</span> <span class="n">module</span><span class="o">/</span><span class="n">package</span><span class="p">,</span> <span class="n">service</span> <span class="n">endpoint</span> <span class="n">URL</span><span class="p">,</span> <span class="ow">or</span> <span class="n">Docker</span>
                        <span class="n">image</span>
  <span class="o">--</span><span class="n">train</span> <span class="n">PATH</span>          <span class="n">Train</span> <span class="n">over</span> <span class="n">the</span> <span class="n">dataset</span> <span class="n">at</span> <span class="n">the</span> <span class="n">local</span> <span class="n">path</span>
  <span class="o">--</span><span class="n">transfer</span><span class="o">-</span><span class="n">learning</span>   <span class="n">Flag</span> <span class="n">indicating</span> <span class="n">that</span> <span class="n">the</span> <span class="n">training</span> <span class="n">operation</span> <span class="n">will</span> <span class="n">be</span>
                        <span class="n">performing</span> <span class="n">transfer</span> <span class="n">learning</span>
  <span class="o">--</span><span class="n">predict</span> <span class="n">PATH</span>        <span class="n">Run</span> <span class="n">predictions</span> <span class="n">over</span> <span class="n">the</span> <span class="n">dataset</span> <span class="n">at</span> <span class="n">the</span> <span class="n">local</span> <span class="n">path</span>
  <span class="o">--</span><span class="n">evaluate</span> <span class="n">TYPE</span>       <span class="n">Evaluate</span> <span class="n">model</span> <span class="n">predictions</span> <span class="k">as</span> <span class="n">one</span> <span class="n">of</span><span class="p">:</span>
                        <span class="n">BinaryClassification</span><span class="p">,</span> <span class="n">MultilabelClassification</span><span class="p">,</span>
                        <span class="n">MulticlassClassification</span><span class="p">,</span> <span class="n">Regression</span> <span class="p">(</span><span class="n">requires</span>
                        <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span><span class="p">,</span> <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span><span class="p">)</span>
  <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>
                        <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">to</span> <span class="n">save</span><span class="o">/</span><span class="n">load</span> <span class="n">model</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">used</span>
                        <span class="k">with</span> <span class="n">the</span> <span class="o">--</span><span class="n">predict</span> <span class="ow">and</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">options</span>
  <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>
                        <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">containing</span> <span class="n">dataset</span> <span class="n">ground</span> <span class="n">truth</span><span class="p">,</span>
                        <span class="n">used</span> <span class="k">with</span> <span class="n">the</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">option</span>
  <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>     <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">to</span> <span class="n">load</span> <span class="n">model</span> <span class="n">checkpoints</span><span class="p">,</span> <span class="n">used</span> <span class="k">with</span>
                        <span class="n">the</span> <span class="o">--</span><span class="n">train</span> <span class="ow">or</span> <span class="o">--</span><span class="n">predict</span> <span class="n">options</span>
  <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>
                        <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">to</span> <span class="n">save</span> <span class="n">model</span> <span class="n">checkpoints</span><span class="p">,</span> <span class="n">used</span> <span class="k">with</span>
                        <span class="n">the</span> <span class="o">--</span><span class="n">train</span> <span class="n">option</span>
  <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">props</span> <span class="n">FILE</span>    <span class="n">Local</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">json</span> <span class="n">dictionary</span> <span class="n">of</span> <span class="n">model</span>
                        <span class="n">properties</span>
  <span class="o">--</span><span class="n">hyperparams</span> <span class="n">FILE</span>    <span class="n">Local</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">json</span> <span class="n">dictionary</span> <span class="n">of</span> <span class="n">model</span>
                        <span class="n">hyperparameters</span>
  <span class="o">--</span><span class="n">stream</span><span class="o">-</span><span class="n">predict</span> <span class="n">FILE</span>
                        <span class="n">Local</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">json</span> <span class="n">dictionary</span> <span class="n">of</span> <span class="n">ids</span> <span class="n">to</span> <span class="n">base64</span>
                        <span class="n">encoded</span> <span class="nb">input</span> <span class="n">data</span>
  <span class="o">--</span><span class="n">transform</span> <span class="n">TRANSFORM</span>
                        <span class="n">Transform</span> <span class="n">module</span><span class="o">/</span><span class="n">package</span><span class="p">,</span> <span class="n">service</span> <span class="n">endpoint</span> <span class="n">URL</span><span class="p">,</span> <span class="ow">or</span>
                        <span class="n">Docker</span> <span class="n">image</span>
  <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>
                        <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">to</span> <span class="n">save</span> <span class="n">results</span> <span class="n">of</span> <span class="n">transformation</span>
  <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">paths</span> <span class="n">PATH</span> <span class="p">[</span><span class="n">PATH</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">One</span> <span class="ow">or</span> <span class="n">more</span> <span class="n">local</span> <span class="n">folder</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="k">as</span> <span class="nb">input</span>
                        <span class="n">directories</span> <span class="n">when</span> <span class="n">performing</span> <span class="n">a</span> <span class="n">transformation</span>
  <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">properties</span> <span class="n">FILE</span>
                        <span class="n">Local</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">json</span> <span class="n">dictionary</span> <span class="n">of</span> <span class="n">transform</span>
                        <span class="n">properties</span>
  <span class="o">--</span><span class="n">evaluation</span> <span class="n">EVALUATION</span>
                        <span class="n">Evaluation</span> <span class="n">module</span><span class="o">/</span><span class="n">package</span><span class="p">,</span> <span class="n">service</span> <span class="n">endpoint</span> <span class="n">URL</span><span class="p">,</span> <span class="ow">or</span>
                        <span class="n">Docker</span> <span class="n">image</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="n">PATH</span>
                        <span class="n">Local</span> <span class="n">folder</span> <span class="n">path</span> <span class="n">to</span> <span class="n">save</span> <span class="n">results</span> <span class="n">of</span> <span class="n">evaluation</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">properties</span> <span class="n">FILE</span>
                        <span class="n">Local</span> <span class="n">file</span> <span class="n">containing</span> <span class="n">json</span> <span class="n">dictionary</span> <span class="n">of</span> <span class="n">evaluation</span>
                        <span class="n">properties</span>
  <span class="o">--</span><span class="n">metrics</span> <span class="n">METRIC</span>      <span class="n">Comma</span> <span class="n">delimited</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">metric</span> <span class="n">names</span> <span class="k">for</span> <span class="n">metrics</span> <span class="n">to</span> <span class="n">be</span>
                        <span class="n">evaluated</span><span class="o">.</span>
  <span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">shutdown</span>
                        <span class="n">Disables</span> <span class="n">automatic</span> <span class="n">shutdown</span> <span class="n">of</span> <span class="n">the</span> <span class="n">model</span> <span class="ow">or</span> <span class="n">transform</span>
                        <span class="n">docker</span> <span class="n">container</span>
  <span class="o">--</span><span class="n">logs</span>                <span class="n">Show</span> <span class="nb">all</span> <span class="n">MISTK</span> <span class="n">log</span> <span class="n">output</span> <span class="p">(</span><span class="n">debug</span><span class="p">)</span>

<span class="n">Examples</span><span class="p">:</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">train</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">trained</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">MyImplementedModel</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">train</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">trained</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">train</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">save</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">trained</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span> <span class="n">repo</span><span class="o">/</span><span class="n">mymodelimpl</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">predict</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">model</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">model</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">predictions</span><span class="o">/</span><span class="n">folder</span>
  <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">ground</span><span class="o">/</span><span class="n">truth</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">BinaryClassification</span> <span class="o">--</span><span class="n">model</span> <span class="n">mymodel</span><span class="o">.</span><span class="n">MyImplementedModel</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">BinaryClassification</span> <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">predictions</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">ground</span><span class="o">/</span><span class="n">truth</span><span class="o">/</span><span class="n">folder</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">evaluation</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="n">folder</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">BinaryClassification</span> <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">predictions</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">ground</span><span class="o">/</span><span class="n">truth</span><span class="o">/</span><span class="n">folder</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">evaluation</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">evaluation</span> <span class="n">myevaluation</span><span class="o">.</span><span class="n">MyImplementedEvaluation</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">MulticlassClassification</span> <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">predictions</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">ground</span><span class="o">/</span><span class="n">truth</span><span class="o">/</span><span class="n">folder</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">evaluation</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">evaluation</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">evaluate</span> <span class="n">MulticlassClassification</span> <span class="o">--</span><span class="n">predictions</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">predictions</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">ground</span><span class="o">-</span><span class="n">truth</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">ground</span><span class="o">/</span><span class="n">truth</span><span class="o">/</span><span class="n">folder</span>
  <span class="o">--</span><span class="n">evaluation</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">evaluation</span><span class="o">/</span><span class="n">output</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">evaluation</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span> <span class="o">--</span><span class="n">metrics</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">,</span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">paths</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">folder</span><span class="o">/</span><span class="mi">1</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">folder</span><span class="o">/</span><span class="mi">2</span> <span class="o">...</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">folder</span><span class="o">/</span><span class="n">n</span>
  <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">properties</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="n">properties</span><span class="o">/</span><span class="n">file</span> <span class="o">--</span><span class="n">transform</span> <span class="n">mytransform</span><span class="o">.</span><span class="n">MyTransformImplementation</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">paths</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">transform</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">localhost</span><span class="p">:</span><span class="mi">8080</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">mistk_test_harness</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="n">output</span><span class="o">-</span><span class="n">path</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span> <span class="o">--</span><span class="n">transform</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="n">paths</span> <span class="o">/</span><span class="n">my</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">folder</span> <span class="o">--</span><span class="n">transform</span> <span class="n">repo</span><span class="o">/</span><span class="n">mytransformimpl</span>
</pre></div>
</div>
<p>The ‘–train’ and ‘–predict’ parameters take a path to a folder containing the data
for training and testing, respectively. These paths will be passed to the model
during the <cite>load_data</cite> stage.</p>
<p>The ‘–predictions-path’ is a folder that will be
passed to the model during the <cite>save_predictions</cite> stage.
The ‘–ground-truth-path’ is a folder containing dataset ground truth. Ground truth should be formatted
in accordance with the <cite>Predictions and Ground Truth</cite> section and be named
ground_truth.csv.</p>
<p>The ‘–model-path’ parameter is a folder for loading model checkpoints.
This path is passed to the model during the <cite>build_model</cite> stage.</p>
<p>The ‘–model-save-path’ parameter is a folder for saving model checkpoints after
training. This path is passed to the model during the ‘save_model’ stage.</p>
<p>The ‘–stream-predict’ parameter points to a JSON file containing key-value pairs
of ids and base64 encoded values for prediction.</p>
<p>The ‘–model-props’ and ‘–hyperparams’ parameters point to JSON files
containing key-value pairs of any variables specific to the model. These variables
and values will be passed to the model during the <cite>initialize</cite> stage. Below are some
examples of valid json:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;samples_fit&quot;</span><span class="p">:</span> <span class="mi">768</span><span class="p">,</span>
  <span class="nt">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
  <span class="nt">&quot;arch&quot;</span><span class="p">:</span> <span class="s2">&quot;densenet&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The Test Harness accepts three types of parameters for MODEL. The first is to simply
pass the model class directly in the format of <cite>package.module.ClassName</cite>. The model
must be loadable from the system path. The second is to pass the URL for an
already running model instance. The standard URL would be of the form
<cite>http://localhost:8080</cite>. Finally, the third option for passing a model is to pass
a built Docker image. In this case, the Test Harness will start the container and
connect to it. The format to use for this method is <cite>[&lt;registry-host:port&gt;/]repo/name[:tag]</cite>.</p>
<p>Example output from validating a train/predict workflow is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Called</span> <span class="s1">&#39;initialize&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;initialized&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">initialized</span>
<span class="n">Called</span> <span class="s1">&#39;build_model&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;initialized&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">initialized</span>
<span class="n">Called</span> <span class="s1">&#39;load_data&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;ready&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">ready</span>
<span class="n">Called</span> <span class="s1">&#39;train&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;ready&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">training</span> <span class="p">({</span><span class="s1">&#39;samples_fit&#39;</span><span class="p">:</span> <span class="mi">768</span><span class="p">})</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">ready</span>
<span class="n">Called</span> <span class="s1">&#39;save_model&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;ready&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">ready</span>
<span class="n">Called</span> <span class="s1">&#39;predict&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;ready&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">predicting</span> <span class="p">({</span><span class="s1">&#39;samples_predicted&#39;</span><span class="p">:</span> <span class="mi">768</span><span class="p">})</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">ready</span>
<span class="n">Called</span> <span class="s1">&#39;save_predictions&#39;</span> <span class="n">on</span> <span class="n">model</span><span class="p">,</span> <span class="n">waiting</span> <span class="k">for</span> <span class="n">state</span> <span class="n">change</span> <span class="n">to</span> <span class="s1">&#39;ready&#39;</span>
<span class="n">Model</span> <span class="n">state</span><span class="p">:</span> <span class="n">ready</span>
<span class="n">Validation</span> <span class="n">completed</span>
</pre></div>
</div>
<p>Of note, the Test Harness application suppresses standard python logging output by default.
Pass the ‘–logs’ parameter to show all logging output on the console.</p>
</div>
<div class="section" id="validation-metrics">
<h2>Validation Metrics<a class="headerlink" href="#validation-metrics" title="Permalink to this headline">¶</a></h2>
<p>The Test Harness runs various metrics against model predictions when passed the
‘–evaluate’ flag to aid the developer in determining model correctness and
performance. The evaluation output will be saved in JSON format at the path
specified with the ‘–evaluations-output-path’ flag. The Test Harness provides
default metrics to evaluate models, but additional metrics can be added through
using an evaluation module/container with the ‘–evaluation’ flag.</p>
<p>The evaluation types and default metrics:</p>
<p>Binary Classification:</p>
<ul class="simple">
<li><p>Accuracy - The percentage of samples predicted correctly.</p></li>
<li><p>Matthews Correlation Coefficient - The Matthews correlation coefficient is used
in machine learning as a measure of the quality of binary and multiclass classifications.
It takes into account true and false positives and negatives and is generally regarded as
a balanced measure which can be used even if the classes are of very different sizes.</p></li>
<li><p>Hamming Loss - The fraction of labels that are incorrectly predicted.</p></li>
<li><p>F1 Score - Metric measuring the weighted average of the precision and recall,
where an F1 score reaches its best value at 1 and worst score at 0.</p></li>
<li><p>Log Loss - This is the loss function used in (multinomial) logistic regression and
extensions of it such as neural networks, defined as the negative log-likelihood
of the true labels given a probabilistic classifier’s predictions.</p></li>
<li><p>F-beta Score - Metric measuring the weighted harmonic mean of precision and recall,
reaching its optimal value at 1 and its worst value at 0.</p></li>
<li><p>Recall - The ratio of true positions to the sum of true positives and false negatives.</p></li>
<li><p>Precision - The ratio of true positions to the sum of true positives and false positives.</p></li>
<li><p>Brier Score - A proper score function that measures the accuracy of probabilistic predictions.
It is applicable to tasks in which predictions must assign probabilities to a set
of mutually exclusive discrete outcomes.</p></li>
<li><p>ROC - A receiver operating characteristic (ROC), or simply ROC curve, is a graphical
plot which illustrates the performance of a binary classifier system as its
discrimination threshold is varied. It is created by plotting the fraction of true
positives out of the positives (TPR = true positive rate) vs. the fraction of false positives
out of the negatives (FPR = false positive rate), at various threshold settings.
TPR is also known as sensitivity, and FPR is one minus the specificity or true negative rate.</p></li>
<li><p>ROC AUC - Metric computing the area under the receiver operating characteristic (ROC) curve,
which is also denoted by AUC or AUROC. By computing the area under the roc curve,
the curve information is summarized in one number.</p></li>
</ul>
<p>Multiclass/Multilabel Classification:</p>
<ul class="simple">
<li><p>Accuracy - The percentage of samples predicted correctly.</p></li>
<li><p>Hamming Loss - The fraction of labels that are incorrectly predicted.</p></li>
<li><p>F1 Score - Metric measuring the weighted average of the precision and recall,
where an F1 score reaches its best value at 1 and worst score at 0.</p></li>
<li><p>Log Loss - This is the loss function used in (multinomial) logistic regression and
extensions of it such as neural networks, defined as the negative log-likelihood
of the true labels given a probabilistic classifier’s predictions.</p></li>
<li><p>F-beta Score - Metric measuring the weighted harmonic mean of precision and recall,
reaching its optimal value at 1 and its worst value at 0.</p></li>
<li><p>Recall - The ratio of true positions to the sum of true positives and false negatives.</p></li>
<li><p>Precision - The ratio of true positions to the sum of true positives and false positives.</p></li>
</ul>
<p>Regression:</p>
<ul class="simple">
<li><p>Explained Variance - The explained variance regression score.</p></li>
<li><p>Mean Absolute Error - A risk metric corresponding to the expected value of the
absolute error loss or l1-norm loss.</p></li>
<li><p>Mean Squared Error - A risk metric corresponding to the expected value of the
squared (quadratic) error or loss.</p></li>
<li><p>Mean Squared Log Error - A risk metric corresponding to the expected value of
the squared logarithmic (quadratic) error or loss.</p></li>
<li><p>R2 Score - The coefficient of determination, representing the proportion of
variance (of y) that has been explained by the independent variables in the model</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="deployment.html" class="btn btn-neutral float-right" title="Deployment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="guide.html" class="btn btn-neutral float-left" title="Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>